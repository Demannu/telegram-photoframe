(this["webpackJsonpphotoframe-react"]=this["webpackJsonpphotoframe-react"]||[]).push([[0],{32:function(t,e,n){},33:function(t,e,n){"use strict";n.r(e);var a=n(1),r=n(0),i=n.n(r),c=n(15),o=n.n(c),s=n(3),u=n(16),d=n.n(u),p=n(2),l=n.n(p),h=n(4),f=n(5),b=n(17),j=n.n(b),g=n.p+"static/media/logo.eea735da.png",y=f.a.div({display:"grid",placeItems:"center"});function m(t){var e=t.event,n=t.client,r=i.a.useRef();return i.a.useEffect((function(){function t(){return(t=Object(h.a)(l.a.mark((function t(){var a,i;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=e.authorization_state["@type"],t.t0=a,t.next="authorizationStateWaitEncryptionKey"===t.t0?4:"authorizationStateClosed"===t.t0||"authorizationStateWaitPhoneNumber"===t.t0?7:"authorizationStateWaitOtherDeviceConfirmation"===t.t0?10:14;break;case 4:return t.next=6,n.current.send({"@type":"checkDatabaseEncryptionKey"});case 6:return t.abrupt("break",15);case 7:return t.next=9,n.current.send({"@type":"requestQrCodeAuthentication",other_user_ids:[]});case 9:return t.abrupt("break",15);case 10:return i=new j.a({width:400,height:400,data:e.authorization_state.link,image:g,dotsOptions:{color:"#25abec",type:"square"},backgroundOptions:{color:"transparent"},imageOptions:{crossOrigin:"anonymous",margin:20}}),r.current.innerHTML="",i.append(r.current),t.abrupt("break",15);case 14:return t.abrupt("break",15);case 15:case"end":return t.stop()}}),t)})))).apply(this,arguments)}n.current&&(null===e||void 0===e?void 0:e.authorization_state)&&function(){t.apply(this,arguments)}()}),[n,e]),Object(a.jsxs)(y,{children:[Object(a.jsx)("h1",{children:"Login with your device"}),Object(a.jsx)("div",{ref:r})]})}var v=n(10),x=n(7),O=n(13),_=f.a.button({padding:10,border:"none",font:"inherit",color:"inherit",backgroundColor:"light-grey",borderRadius:"50%",height:50,width:50,fontSize:"1.5rem",margin:5});function w(t){var e=t.client,n=t.text,r=t.children,i=Object(O.a)("/pop-down.mp3",{volume:.25}),c=Object(s.a)(i,1)[0],o=Object(O.a)("/pop-up-on.mp3",{volume:.25}),u=Object(s.a)(o,1)[0];return Object(a.jsx)(_,{onMouseDown:c,onMouseUp:function(t){u(),function(t){e.current.send({"@type":"sendMessage",chat_id:-440888561,reply_to_message_id:0,input_message_content:{"@type":"inputMessageText",text:{"@type":"formattedText",text:t,entities:[]}}})}(n)},children:r})}var S=f.a.div.withConfig({displayName:"Slideshow__Container",componentId:"dxjitx-0"})({overflow:"hidden",height:600,width:1024}),k=f.a.div.withConfig({displayName:"Slideshow__Picture",componentId:"dxjitx-1"})((function(t){var e=t.blob;return{width:"100%",height:600,backgroundImage:"url(".concat(e,")"),backgroundPosition:"center",backgroundRepeat:"no-repeat",backgroundSize:"cover"}})),C=f.a.div.withConfig({displayName:"Slideshow__Caption",componentId:"dxjitx-2"})({position:"relative",top:-60,left:"2%",color:"white",fontSize:"2rem"}),z=f.a.div.withConfig({displayName:"Slideshow__Reactions",componentId:"dxjitx-3"})({position:"relative",top:-120,left:"85%",display:"flex",flexDirection:"row"});function I(t){var e=t.client,n=t.history,r=i.a.useState(),c=Object(s.a)(r,2),o=c[0],u=c[1],d=i.a.useState([]),p=Object(s.a)(d,2),f=p[0],b=p[1],j=i.a.useState(""),g=Object(s.a)(j,2),y=g[0],m=g[1];return i.a.useEffect((function(){function t(){return(t=Object(h.a)(l.a.mark((function t(){var a,r,i,c,o,s,d,p,h;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("messagePhoto"!==(null===(r=Object(x.last)(n))||void 0===r||null===(a=r.content)||void 0===a?void 0:a["@type"])){t.next=14;break}return i=r.content,c=i.caption,o=i.photo,s=Object(x.last)(o.sizes),d=s.photo.id,t.next=7,e.current.send({"@type":"downloadFile",file_id:d,priority:1,synchronous:!0});case 7:return t.next=9,e.current.send({"@type":"readFile",file_id:d});case 9:p=t.sent,h=URL.createObjectURL(p.data),u(d),b(h),m(null===c||void 0===c?void 0:c.text);case 14:case"end":return t.stop()}}),t)})))).apply(this,arguments)}n&&function(){t.apply(this,arguments)}()}),[n]),Object(a.jsxs)(S,{children:[Object(a.jsx)(k,{"data-testis":o,blob:f}),Object(a.jsx)(C,{children:y}),Object(a.jsxs)(z,{children:[Object(a.jsx)(w,{client:e,text:"\u2665\ufe0f",children:"\u2665\ufe0f"}),Object(a.jsx)(w,{client:e,text:"\ud83e\udd70",children:"\ud83e\udd70"})]})]})}var E=function(t,e){var n=Object(r.useState)((function(){try{var n=window.localStorage.getItem(t);return n?JSON.parse(n):e}catch(a){return console.log(a),e}})),a=Object(s.a)(n,2),i=a[0],c=a[1];return[i,function(e){try{var n=e instanceof Function?e(i):e;c(n),window.localStorage.setItem(t,JSON.stringify(n))}catch(a){console.log(a)}}]};function M(t){var e=t.client,n=t.callback,r=i.a.useState([]),c=Object(s.a)(r,2),o=c[0],u=c[1];return i.a.useEffect((function(){function t(){return(t=Object(h.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.current.send({"@type":"getChats",chat_list:{"@type":"chatListMain"},offset_order:"9223372036854775807",offset_chat_id:0,limit:10});case 2:t.sent.chat_ids.map(function(){var t=Object(h.a)(l.a.mark((function t(n){var a;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.current.send({"@type":"getChat",chat_id:n});case 2:a=t.sent,u((function(t){return[].concat(Object(v.a)(t),[{id:n,title:a.title}])}));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[e]),Object(a.jsxs)("div",{children:[Object(a.jsx)("div",{children:"Select a chat to display"}),Object(a.jsx)("ul",{children:o.map((function(t){return Object(a.jsx)("li",{onClick:function(e){return n(t.id)},children:t.title},t.id)}))})]})}var N=f.a.div.withConfig({displayName:"EmptyChat__Container",componentId:"jss9dm-0"})({display:"grid",placeItems:"center",height:"100vh"}),F=f.a.div.withConfig({displayName:"EmptyChat__ChatPicture",componentId:"jss9dm-1"})((function(t){var e=t.src;return{height:400,width:400,borderRadius:"50%",backgroundImage:"url(".concat(e,")"),backgroundPosition:"center",backgroundRepeat:"no-repeat",backgroundSize:"cover"}})),L=f.a.div.withConfig({displayName:"EmptyChat__Message",componentId:"jss9dm-2"})({fontSize:"2rem"});function R(t){var e=t.client,n=t.chatId,r=i.a.useState(null),c=Object(s.a)(r,2),o=c[0],u=c[1],d=i.a.useState(null),p=Object(s.a)(d,2),f=p[0],b=p[1];return i.a.useEffect((function(){function t(){return(t=Object(h.a)(l.a.mark((function t(){var a,r,i,c;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.current.send({"@type":"getChats",chat_list:{"@type":"chatListMain"},offset_order:"9223372036854775807",offset_chat_id:n,limit:1});case 2:return t.next=4,e.current.send({"@type":"getChat",chat_id:n});case 4:return a=t.sent,r=a.photo.big.id,t.next=8,e.current.send({"@type":"downloadFile",file_id:r,priority:1,synchronous:!0});case 8:return t.next=10,e.current.send({"@type":"readFile",file_id:r});case 10:i=t.sent,c=URL.createObjectURL(i.data),b(c),u(a.title);case 14:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[e,n]),Object(a.jsxs)(N,{children:[Object(a.jsx)(F,{src:f}),Object(a.jsxs)(L,{children:["Send a picture to '",o,"' to view it here"]})]})}function P(t){var e=t.updates,n=t.client,r=E("chatId"),c=Object(s.a)(r,2),o=c[0],u=c[1],d=i.a.useState([]),p=Object(s.a)(d,2),f=p[0],b=p[1];return i.a.useEffect((function(){function t(){return(t=Object(h.a)(l.a.mark((function t(){var n;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=e["@type"],t.next="updateNewMessage"===t.t0?3:"updateDeleteMessages"===t.t0?5:7;break;case 3:return(null===e||void 0===e||null===(n=e.message)||void 0===n?void 0:n.chat_id)===o&&b((function(t){return[].concat(Object(v.a)(t),[null===e||void 0===e?void 0:e.message])})),t.abrupt("break",8);case 5:return e.chat_id===o&&e.message_ids.forEach(function(){var t=Object(h.a)(l.a.mark((function t(e){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:b((function(t){return t.filter((function(t){return t.id!==e}))}));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),t.abrupt("break",8);case 7:return t.abrupt("break",8);case 8:case"end":return t.stop()}}),t)})))).apply(this,arguments)}e&&function(){t.apply(this,arguments)}()}),[e]),i.a.useEffect((function(){function t(){return(t=Object(h.a)(l.a.mark((function t(){var e;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("Fetching chats"),t.next=3,n.current.send({"@type":"getChats",chat_list:{"@type":"chatListMain"},offset_order:"9223372036854775807",offset_chat_id:o,limit:1});case 3:return console.log("Fetching history for:",o),t.next=6,n.current.send({"@type":"getChatHistory",chat_id:o,limit:1e3});case 6:e=t.sent,b(e.messages);case 8:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[]),o?Object(x.isEmpty)(f)?Object(a.jsx)(R,{client:n,chatId:o}):Object(a.jsx)(I,{client:n,history:f}):Object(a.jsx)(M,{client:n,callback:u})}n(31),n(32);var D=function(){var t=i.a.useState(),e=Object(s.a)(t,2),n=e[0],r=e[1],c=i.a.useState(),o=Object(s.a)(c,2),u=o[0],p=o[1],l=i.a.useRef();if(i.a.useEffect((function(){console.log("Initializing tdlib"),l.current=new d.a({useTestDC:!1,readOnly:!1,verbosity:3,jsVerbosity:3,fastUpdating:!0,useDatabase:!1,mode:"wasm"})}),[]),i.a.useEffect((function(){l.current.onUpdate=function(t){t&&"updateAuthorizationState"===t["@type"]&&r(t),!t||"updateNewMessage"!==t["@type"]&&"updateDeleteMessages"!==t["@type"]||p(t)},l.current.send({"@type":"setTdlibParameters",parameters:{"@type":"tdParameters",use_test_dc:!1,api_id:"10726",api_hash:"f896fe83f2e0a25b99b44c9aad2421f3",system_language_code:navigator.language||"en",device_model:"Telegram Frame",application_version:"0.1",use_secret_chats:!1,use_message_database:!1,use_file_database:!1,files_directory:"/"}})}),[l]),!n||!n.authorization_state)return Object(a.jsx)("div",{children:"Loading..."});switch(n.authorization_state["@type"]){case"authorizationStateWaitEncryptionKey":case"authorizationStateWaitOtherDeviceConfirmation":case"authorizationStateWaitPhoneNumber":case"updateAuthorizationState":case"authorizationStateClosed":return Object(a.jsx)(m,{event:n,client:l});case"authorizationStateReady":return Object(a.jsx)(P,{updates:u,client:l});default:return null}},T=function(t){t&&t instanceof Function&&n.e(4).then(n.bind(null,35)).then((function(e){var n=e.getCLS,a=e.getFID,r=e.getFCP,i=e.getLCP,c=e.getTTFB;n(t),a(t),r(t),i(t),c(t)}))};o.a.render(Object(a.jsx)(i.a.StrictMode,{children:Object(a.jsx)(D,{})}),document.getElementById("root")),T()}},[[33,1,2]]]);
//# sourceMappingURL=main.6376e173.chunk.js.map